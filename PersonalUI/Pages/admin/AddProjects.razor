@page "/admin/editprojects"

@using PersonalUI.Data
@using PersonalUI.Models

@inject IProjectsData _projects

<AuthorizeView>
    <Authorized>
        <div class="container-fluid">
            <div class="container border-bottom border-dark">
                <h3 class="mt-3 p-2">
                    Edit projects
                </h3>
                <p class="p-2">Projects can be found in 'My work' page</p>
            </div>

            <div class="container border-bottom border-dark">
                <h4 class="mt-3 p-2">
                    Current projects
                </h4>
                <div class="container mt-3 pt-3 border-top border-light largest-projects" style="height: 400px; overflow-y: auto;">
                    <ul>
                        @if (projects is null) {
                            <li><em>Loading..</em></li>
                        }
                        else {
                            foreach (var p in projects) {
                                string[] stack = p.Stack.Split("|");
                                <li>
                                    <div class="row border-bottom p-3 border-dark">
                                        <div class="col-md-8">
                                            <h5 class="mb-2 pb-2">@p.Title</h5>
                                            <p>@p.Description</p>
                                        </div>
                                        <div class="col-md-4">
                                            <ul class="used-stack">
                                                @foreach (var s in stack) {
                                                    <li>@s</li>
                                                }
                                            </ul>
                                        </div>
                                    </div>
                                </li>
                            }
                        }
                    </ul>
                </div>
            </div>

            <div class="container m-2">
                <form class="">
                    <div class="row d-flex justify-content-end mt-4">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="color-white"><i>Title</i></label>
                                <input type="text" name="title" class="form-control" id="titleInput" placeholder="Title" required />
                            </div>
                            <button class="btn btn-primary">Save</button>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="color-white"><i>Description</i></label>
                                <input type="text" name="description" class="form-control" id="descriptionInput" placeholder="Description" required />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="color-white"><i>Used stack</i></label>
                                <input type="text" name="stack" class="form-control" id="stackInput" placeholder="Used stack" required />
                                <p class="about-details-small-dark mt-2">Use '|' to seperate list elements</p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </Authorized>
    <NotAuthorized>
        <p class="p-3">You do not have permission to open this page</p>
    </NotAuthorized>
</AuthorizeView>

@code {
    private List<ProjectModel> projects;


    protected override async Task OnInitializedAsync() {

        projects = await _projects.GetProjects();
    }
}
